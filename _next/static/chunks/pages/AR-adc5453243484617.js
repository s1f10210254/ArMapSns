(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{4747:function(t,e,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AR",function(){return o(7892)}])},7892:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return index_page}});var i=o(5893),n=o(8583),a=o(1664),l=o.n(a),s=o(7294),c=o(6221),d=o(3483),u=o(6819),r=o(5123),g=o.n(r),ar_page=()=>{let[t]=(0,n.KO)(c.LF),[e,o]=(0,n.KO)(c.ge),[a,r]=(0,s.useState)(null),p=(0,s.useCallback)(async()=>{if(null===e.latitude||null===e.longitude)return;let t=e.latitude,o=e.longitude,i=await d.x.posts.$get({query:{latitude:t,longitude:o}}).catch(u.F);r(i),console.log("getPosts")},[e.latitude,e.longitude]);(0,s.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(t=>{o({latitude:t.coords.latitude,longitude:t.coords.longitude})})},[o]);let[f,h]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(f&&null!==e.latitude&&null!==e.longitude){let oneRendaringGetPosts=async()=>{let t=e.latitude,o=e.longitude,i=await d.x.posts.$get({query:{latitude:t,longitude:o}}).catch(u.F);r(i)};oneRendaringGetPosts(),h(!1)}},[e.latitude,e.longitude,f]);let[x,y]=(0,s.useState)(0);return window.handleLike=async e=>{if((null==t?void 0:t.id)===void 0||void 0===e)return;let o=await d.x.posts.$post({body:{postId:e,userId:t.id}});console.log("result",o),y(o),await p(),console.log("result",o),console.log("likecount",x)},(0,s.useEffect)(()=>{void 0===AFRAME.components["hit-box"]&&AFRAME.registerComponent("hit-box",{schema:{postId:{type:"string"}},init(){this.el.addEventListener("click",()=>{let t=this.data.postId;console.log("postID",t),window.handleLike(t)})}}),void 0===AFRAME.components.log&&AFRAME.registerComponent("log",{schema:{type:"string"},init(){let t=this.data;console.log("log内容",t)}})},[]),(0,i.jsxs)("div",{children:[(0,i.jsx)(l(),{href:"/",children:(0,i.jsx)("button",{className:g().mapButton,children:"MAP"})}),null!==e.latitude&&null!==e.longitude&&(0,i.jsxs)("div",{className:g().coordinatesInfo,children:["Latitude: ",e.latitude,", Longitude: ",e.longitude]}),(0,i.jsxs)("a-scene",{"vr-mode-ui":"enabled: false",embedded:!0,arjs:"sourceType: webcam; debugUIEnabled: false;",children:[null==a?void 0:a.map((e,o)=>(0,i.jsxs)("a-entity",{id:"post".concat(o),position:"".concat(2*o," 1 -1"),rotation:"0 0 0",children:[e.id===(null==t?void 0:t.id)?(0,i.jsx)("a-plane",{color:"#b4b9de",height:"1",width:"1.5",position:"0 0 -0.1"}):(0,i.jsx)("a-plane",{color:"#e3e69a",height:"1",width:"1.5",position:"0 0 -0.1"}),(0,i.jsx)("a-plane",{color:"#ffffff",height:"0.5",width:"1",position:"0 0.2 -0.099",align:"center"}),(0,i.jsx)("a-text",{value:e.content,position:"0 0.2 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.4 0.4 0.4",color:"black",align:"center"}),(0,i.jsx)("a-entity",{position:"-0.4 -0.3 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),"gltf-model":"/models/love_heart.gltf",scale:"0.0008 0.0007 0.0005"}),(0,i.jsx)("a-entity",{position:"-0.4, -0.225 0","hit-box":"postId: ".concat(e.id),children:(0,i.jsx)("a-entity",{class:"raycastable","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),geometry:"primitive:box",material:"color:blue; opacity: 0.5",scale:"0.2 0.2 0.1",position:"0 0 0",visible:"false"})}),(0,i.jsx)("a-text",{value:"Likes: ".concat(e.likeCount),position:"-0.48 -0.1 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.2 0.2 0.2",color:"black"}),(0,i.jsx)("a-text",{value:"".concat(e.postTime),position:"0.1 -0.3 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.15 0.15 0.15",color:"#373535"})]},o)),(0,i.jsx)("a-camera",{"gps-camera":!0,"rotation-reader":!0}),(0,i.jsx)("a-entity",{id:"mouseCursor",cursor:"rayOrigin: mouse",raycaster:"objects: .raycastable"})]})]})},index_page=()=>(0,i.jsx)("div",{children:(0,i.jsx)(ar_page,{})})},5123:function(t){t.exports={mapButton:"ar_mapButton__k_EPZ",coordinatesInfo:"ar_coordinatesInfo__1KWgl"}}},function(t){t.O(0,[664,774,888,179],function(){return t(t.s=4747)}),_N_E=t.O()}]);