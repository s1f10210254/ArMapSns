(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{4498:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return t(8662)}])},8662:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return index_page}});var a=t(5893),i=t(7294),l=t(4076),s=t(5103),r=t(8583),u=t(9854);let o=(0,s.cn)(0),c=(0,s.cn)(e=>e(o)>0),useLoading=()=>{let[e,n]=(0,r.KO)(o),[t]=(0,r.KO)(c),l=(0,i.useCallback)(()=>n(e+1),[e,n]),s=(0,i.useCallback)(()=>n(e-1),[e,n]);return{loadingElm:(0,a.jsx)(u.g,{visible:t}),addLoading:l,removeLoading:s}};var d=t(8256),h=t.n(d),index_page=()=>{let{loadingElm:e,addLoading:n,removeLoading:t}=useLoading(),[s,r]=(0,i.useState)(""),[u,o]=(0,i.useState)(""),loginEmail=async()=>{n(),await (0,l.id)(s,u),t()};return(0,a.jsxs)("div",{className:h().container,children:[(0,a.jsxs)("div",{className:h().main,children:[(0,a.jsx)("div",{className:h().title,children:"ArMapSNS"}),(0,a.jsx)("input",{type:"email",value:s,onChange:e=>r(e.target.value),placeholder:"Email"}),(0,a.jsx)("input",{type:"password",value:u,onChange:e=>o(e.target.value),placeholder:"Password"}),(0,a.jsx)("div",{style:{marginTop:"16px"},onClick:loginEmail,children:(0,a.jsx)("div",{className:h().btn,children:(0,a.jsx)("span",{children:"Login with Email"})})})]}),e]})}},4076:function(e,n,t){"use strict";t.d(n,{id:function(){return authWithEmail},kS:function(){return logout}});var a=t(4857),i=t(2509),l=t(3483),s=t(6819);let logout=async()=>{await (0,i.l)().signOut()},checkIfNewUser=async e=>{let n=await l.x.user.$get({query:{userID:e}});0===n.length&&await l.x.user.post({body:{userID:e}}).catch(s.F)},authWithEmail=async(e,n)=>{let t=(0,i.l)();try{let i=await (0,a.e5)(t,e,n),l=i.user.uid;await checkIfNewUser(l),console.log("ログイン成功")}catch(i){if("auth/user-not-found"!==i.code)return console.error("ログイン失敗",i),null;try{let i=await (0,a.Xb)(t,e,n),l=i.user.uid;await checkIfNewUser(l),console.log("新規登録成功")}catch(e){return console.log("新規登録失敗",e),null}}}},8256:function(e){e.exports={container:"login_container__muLWd",main:"login_main__xBhVh",title:"login_title__RHJw5",btn:"login_btn__PrM31"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4498)}),_N_E=e.O()}]);