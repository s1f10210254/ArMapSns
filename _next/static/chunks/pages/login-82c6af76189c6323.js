(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{4498:function(n,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return i(7914)}])},7914:function(n,e,i){"use strict";i.r(e),i.d(e,{default:function(){return index_page}});var t=i(5893),l=i(7294);let GithubIcon=n=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n.size,height:n.size,fill:n.fill,children:(0,t.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})});var a=i(4076),s=i(5103),r=i(8583),c=i(9854);let o=(0,s.cn)(0),u=(0,s.cn)(n=>n(o)>0),useLoading=()=>{let[n,e]=(0,r.KO)(o),[i]=(0,r.KO)(u),a=(0,l.useCallback)(()=>e(n+1),[n,e]),s=(0,l.useCallback)(()=>e(n-1),[n,e]);return{loadingElm:(0,t.jsx)(c.g,{visible:i}),addLoading:a,removeLoading:s}};var h=i(8256),d=i.n(h),index_page=()=>{let{loadingElm:n,addLoading:e,removeLoading:i}=useLoading(),[s,r]=(0,l.useState)(""),[c,o]=(0,l.useState)(""),loginGithub=async()=>{e(),await (0,a._u)(),i()},loginEmail=async()=>{e(),await (0,a.id)(s,c),i()};return(0,t.jsxs)("div",{className:d().container,children:[(0,t.jsxs)("div",{className:d().main,children:[(0,t.jsx)("div",{className:d().title,children:"ArMapSNS"}),(0,t.jsx)("div",{style:{marginTop:"16px"},onClick:loginGithub,children:(0,t.jsxs)("div",{className:d().btn,children:[(0,t.jsx)(GithubIcon,{size:18,fill:"#fff"}),(0,t.jsx)("span",{children:"Login with GitHub"})]})}),(0,t.jsx)("input",{type:"email",value:s,onChange:n=>r(n.target.value),placeholder:"Email"}),(0,t.jsx)("input",{type:"password",value:c,onChange:n=>o(n.target.value),placeholder:"Password"}),(0,t.jsx)("div",{style:{marginTop:"16px"},onClick:loginEmail,children:(0,t.jsx)("div",{className:d().btn,children:(0,t.jsx)("span",{children:"Login with Email"})})})]}),n]})}},4076:function(n,e,i){"use strict";i.d(e,{_u:function(){return loginWithGitHub},id:function(){return authWithEmail},kS:function(){return logout}});var t=i(4857),l=i(2509),a=i(3483),s=i(6819);let loginWithGitHub=async()=>{let n=new t.GH;n.addScope("read:user"),await (0,t.rh)((0,l.l)(),n).catch(n=>(console.error("Error during sign-in:",n),null))},logout=async()=>{await (0,l.l)().signOut()},checkIfNewUser=async n=>{let e=await a.x.user.$get({query:{userID:n}});0===e.length&&await a.x.user.post({body:{userID:n}}).catch(s.F)},authWithEmail=async(n,e)=>{let i=(0,l.l)();try{let l=await (0,t.e5)(i,n,e),a=l.user.uid;await checkIfNewUser(a),console.log("ログイン成功")}catch(l){if("auth/user-not-found"!==l.code)return console.error("ログイン失敗",l),null;try{let l=await (0,t.Xb)(i,n,e),a=l.user.uid;await checkIfNewUser(a),console.log("新規登録成功")}catch(n){return console.log("新規登録失敗",n),null}}}},8256:function(n){n.exports={container:"login_container__muLWd",main:"login_main__xBhVh",title:"login_title__RHJw5",btn:"login_btn__PrM31"}}},function(n){n.O(0,[774,888,179],function(){return n(n.s=4498)}),_N_E=n.O()}]);