(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[155],{594:function(e,t,n){"use strict";var o=n(4836);t.Z=void 0;var s=o(n(4938)),a=n(5893),c=(0,s.default)((0,a.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.Z=c},7878:function(e,t,n){"use strict";var o=n(4836);t.Z=void 0;var s=o(n(4938)),a=n(5893),c=(0,s.default)((0,a.jsx)("path",{d:"M7.53 21.48C4.26 19.94 1.92 16.76 1.56 13H.06c.51 6.16 5.66 11 11.95 11l.66-.03-3.81-3.81-1.33 1.32zm.89-6.52c-.19 0-.37-.03-.52-.08-.16-.06-.29-.13-.4-.24-.11-.1-.2-.22-.26-.37-.06-.14-.09-.3-.09-.47h-1.3c0 .36.07.68.21.95.14.27.33.5.56.69.24.18.51.32.82.41.3.1.62.15.96.15.37 0 .72-.05 1.03-.15.32-.1.6-.25.83-.44s.42-.43.55-.72.2-.61.2-.97c0-.19-.02-.38-.07-.56-.05-.18-.12-.35-.23-.51-.1-.16-.24-.3-.4-.43-.17-.13-.37-.23-.61-.31.2-.09.37-.2.52-.33.15-.13.27-.27.37-.42.1-.15.17-.3.22-.46s.07-.32.07-.48c0-.36-.06-.68-.18-.96s-.29-.51-.51-.69c-.2-.19-.47-.33-.77-.43C9.11 8.05 8.77 8 8.4 8c-.36 0-.69.05-1 .16-.3.11-.57.26-.79.45-.21.19-.38.41-.51.67-.12.26-.18.54-.18.85h1.3c0-.17.03-.32.09-.45s.14-.25.25-.34.23-.17.38-.22.3-.08.48-.08c.4 0 .7.1.89.31.19.2.29.49.29.86 0 .18-.03.34-.08.49s-.14.27-.25.37c-.11.1-.25.18-.41.24-.16.06-.36.09-.58.09h-.77v1.03h.77c.22 0 .42.02.6.07s.33.13.45.23c.12.11.22.24.29.4s.1.35.1.57c0 .41-.12.72-.35.93-.23.23-.55.33-.95.33zm8.55-5.92c-.32-.33-.7-.59-1.14-.77-.44-.18-.93-.27-1.47-.27H12v8h2.3c.55 0 1.06-.09 1.51-.27s.84-.43 1.16-.76c.32-.33.57-.73.74-1.19.17-.47.26-.99.26-1.57v-.4c0-.58-.09-1.1-.26-1.57s-.42-.87-.74-1.2zm-.39 3.16c0 .42-.05.79-.14 1.13-.1.33-.24.62-.43.85-.19.23-.43.41-.71.53-.29.12-.62.18-.99.18h-.91V9.12h.97c.72 0 1.27.23 1.64.69.38.46.57 1.12.57 1.99v.4zM12.01 0l-.66.03 3.81 3.81 1.33-1.33c3.27 1.55 5.61 4.72 5.96 8.48h1.5C23.45 4.84 18.3 0 12.01 0z"}),"ThreeDRotationTwoTone");t.Z=c},9707:function(e,t,n){"use strict";n.d(t,{Z:function(){return extendSxProp}});var o=n(7462),s=n(3366),a=n(9766),c=n(4920);let i=["sx"],splitProps=e=>{var t,n;let o={systemProps:{},otherProps:{}},s=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:c.Z;return Object.keys(e).forEach(t=>{s[t]?o.systemProps[t]=e[t]:o.otherProps[t]=e[t]}),o};function extendSxProp(e){let t;let{sx:n}=e,c=(0,s.Z)(e,i),{systemProps:r,otherProps:l}=splitProps(c);return t=Array.isArray(n)?[r,...n]:"function"==typeof n?(...e)=>{let t=n(...e);return(0,a.P)(t)?(0,o.Z)({},r,t):r}:(0,o.Z)({},r,n),(0,o.Z)({},l,{sx:t})}},3555:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tests",function(){return n(7946)}])},6221:function(e,t,n){"use strict";n.d(t,{LF:function(){return s},ge:function(){return a}});var o=n(5103);let s=(0,o.cn)(null),a=(0,o.cn)({latitude:null,longitude:null});(0,o.cn)(!0)},9854:function(e,t,n){"use strict";n.d(t,{g:function(){return Loading}});var o=n(5893),s=n(7294),a=n(3935);let Portal=e=>{let{children:t}=e,[n,o]=(0,s.useState)();return(0,s.useEffect)(()=>{let e=document.createElement("div");return document.body.appendChild(e),o(e),()=>{document.body.removeChild(e)}},[]),n?a.createPortal(t,n):null};var c=n(8046),i=n.n(c);let Loading=e=>e.visible?(0,o.jsx)(Portal,{children:(0,o.jsx)("div",{className:i().container,children:(0,o.jsx)("div",{className:i().loader})})}):null},4736:function(e,t,n){"use strict";n.d(t,{v:function(){return BasicHeader}});var o=n(5893),s=n(7878),a=n(1664),c=n.n(a),i=n(1163);let HumanIcon=e=>(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,children:(0,o.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});n(1259);var r=n(6386);n(5066);let logout=async()=>{await (0,r.l)().signOut(),localStorage.removeItem("user")};var l=n(5293),d=n.n(l);let BasicHeader=e=>{let{user:t}=e,n=(0,i.useRouter)(),onLogout=async()=>{confirm("ログアウトしますか？")&&(await logout(),await n.push("/login"))};return(0,o.jsx)("div",{className:d().container,children:(0,o.jsxs)("div",{className:d().main,children:[(0,o.jsxs)("div",{className:d().userBtn,onClick:onLogout,children:[(0,o.jsx)(HumanIcon,{size:30}),(0,o.jsx)("span",{className:d().userName,children:t.displayName})]}),(0,o.jsx)("img",{className:d().logoImage,src:"/images/logo.png",alt:"ARMapConnect Logo"}),(0,o.jsx)(c(),{href:"/AR",children:(0,o.jsx)(s.Z,{fontSize:"large"})})]})})}},7946:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return index_page}});var o=n(5893),s=n(7462),a=n(3366),c=n(7294),i=n(512),r=n(9731),l=n(6523),d=n(9707),u=n(9718);let h=["className","component"];var p=n(7078),g=n(1265),j=n(606);let m=(0,g.Z)(),x=function(e={}){let{themeId:t,defaultTheme:n,defaultClassName:p="MuiBox-root",generateClassName:g}=e,j=(0,r.ZP)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.Z),m=c.forwardRef(function(e,c){let r=(0,u.Z)(n),l=(0,d.Z)(e),{className:m,component:x="div"}=l,y=(0,a.Z)(l,h);return(0,o.jsx)(j,(0,s.Z)({as:x,ref:c,className:(0,i.Z)(m,g?g(p):p),theme:t&&r[t]||r},y))});return m}({themeId:j.Z,defaultTheme:m,defaultClassName:"MuiBox-root",generateClassName:p.Z.generate});var y=n(9417),f=n(4238),v=n(8583),_=n(594),$=n(6221),b=n(9854),T=n(4736),E=n(5066),P=n(6819),index_page=()=>{let[e]=(0,v.KO)($.LF),[t,n]=(0,v.KO)($.ge);(0,c.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(e=>{n({latitude:e.coords.latitude,longitude:e.coords.longitude})})},[n,e]);let[s,a]=(0,c.useState)(null),[i,r]=(0,c.useState)(""),l=(0,c.useCallback)(async()=>{if((null==e?void 0:e.id)===void 0)return;let t=await E.x.myPost.$get({query:{userID:null==e?void 0:e.id}}).catch(P.F);a(t)},[null==e?void 0:e.id]),[d,u]=(0,c.useState)(null),h=(0,c.useCallback)(async()=>{if(null===t.latitude||null===t.longitude)return;let e=t.latitude,n=t.longitude,o=await E.x.posts.$get({query:{latitude:e,longitude:n}}).catch(P.F);u(o)},[t.latitude,t.longitude]),postPostContent=async()=>{if((null==e?void 0:e.id)===void 0||""===i||null===t.latitude||null===t.longitude)return;let n=t.latitude,o=t.longitude;await E.x.myPost.$post({body:{username:"Hirokiの投稿です",content:i,latitude:n,longitude:o,userID:e.id}}),r(""),await l()},deletePostContent=async e=>{await E.x.myPost.$delete({query:{postID:e}}).catch(P.F),await l()},[p,g]=(0,c.useState)(0),handleLike=async t=>{if((null==e?void 0:e.id)===void 0||void 0===t)return;let n=await E.x.posts.$post({body:{postId:t,userId:e.id}});g(n),await h()};(0,c.useEffect)(()=>{l(),h()},[l,h,e]);let formatTime=e=>{let t=new Date(e);return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(t)};return e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.v,{user:e}),(0,o.jsxs)("div",{style:{display:"flex"},children:[(0,o.jsxs)(x,{sx:{padding:2,paddingLeft:10},children:[(0,o.jsx)("h1",{children:"自分の投稿"}),(0,o.jsx)(f.Z,{label:"投稿内容",value:i,onChange:e=>r(e.target.value),InputProps:{endAdornment:(0,o.jsx)(y.Z,{onClick:postPostContent,disabled:!i.trim(),children:"投稿する"})}}),(0,o.jsx)(x,{sx:{paddingTop:2},children:s&&s.map(e=>(0,o.jsxs)("div",{children:[(0,o.jsx)(y.Z,{onClick:()=>deletePostContent(e.id),children:"Delete Post"}),(0,o.jsx)("p",{children:e.postTime}),(0,o.jsxs)("h4",{children:["Content: ",e.content]}),(0,o.jsxs)("p",{children:["latitude: ",e.latitude]}),(0,o.jsxs)("p",{children:["longitude: ",e.longitude]}),(0,o.jsx)(_.Z,{}),(0,o.jsx)("br",{})]},e.id))})]}),(0,o.jsxs)(x,{sx:{padding:2,paddingLeft:10},children:[(0,o.jsxs)("h1",{children:["近くに",d?d.length:0,"件の投稿があります"]}),(0,o.jsx)(x,{sx:{paddingTop:2},children:d&&d.map(e=>(0,o.jsxs)("div",{children:[(0,o.jsx)(y.Z,{onClick:()=>handleLike(e.id),children:"いいね"}),(0,o.jsxs)("p",{children:[e.likeCount,"いいね"]}),(0,o.jsxs)("h3",{children:["user: ",e.userName]}),(0,o.jsxs)("p",{children:["Content: ",e.content]}),(0,o.jsxs)("p",{children:["Time: ",formatTime(e.postTime)]}),(0,o.jsxs)("p",{children:["latitude: ",e.latitude]}),(0,o.jsxs)("p",{children:["longitude: ",e.longitude]}),(0,o.jsx)("br",{})]},e.id))})]})]})]}):(0,o.jsx)(b.g,{visible:!0})}},5066:function(e,t,n){"use strict";n.d(t,{x:function(){return c}});var o=n(9239),s=n(7080),a=n(6154);let c=(e=>{let{baseURL:t,fetch:n}=e,o=(void 0===t?"":t).replace(/\/$/,""),a="/health",c="/likes",i="/myPost",r="/posts",l="/session",d="/tasks",u="/tasks/di",h="/test",p="/user",g="POST",j="DELETE",m="PATCH";return{health:{get:e=>n(o,a,"GET",e).json(),$get:e=>n(o,a,"GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat(a)},likes:{get:e=>n(o,c,"GET",e).json(),$get:e=>n(o,c,"GET",e).json().then(e=>e.body),post:e=>n(o,c,g,e).json(),$post:e=>n(o,c,g,e).json().then(e=>e.body),patch:e=>n(o,c,m,e).json(),$patch:e=>n(o,c,m,e).json().then(e=>e.body),delete:e=>n(o,c,j,e).text(),$delete:e=>n(o,c,j,e).text().then(e=>e.body),$path:e=>"".concat(o).concat(c).concat(e&&e.query?"?".concat((0,s._K)(e.query)):"")},me:{get:e=>n(o,"/me","GET",e).json(),$get:e=>n(o,"/me","GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat("/me")},myPost:{get:e=>n(o,i,"GET",e).json(),$get:e=>n(o,i,"GET",e).json().then(e=>e.body),post:e=>n(o,i,g,e).send(),$post:e=>n(o,i,g,e).send().then(e=>e.body),delete:e=>n(o,i,j,e).send(),$delete:e=>n(o,i,j,e).send().then(e=>e.body),$path:e=>"".concat(o).concat(i).concat(e&&e.query?"?".concat((0,s._K)(e.query)):"")},posts:{get:e=>n(o,r,"GET",e).json(),$get:e=>n(o,r,"GET",e).json().then(e=>e.body),post:e=>n(o,r,g,e).send(),$post:e=>n(o,r,g,e).send().then(e=>e.body),$path:e=>"".concat(o).concat(r).concat(e&&e.query?"?".concat((0,s._K)(e.query)):"")},session:{post:e=>n(o,l,g,e).json(),$post:e=>n(o,l,g,e).json().then(e=>e.body),delete:e=>n(o,l,j,e).json(),$delete:e=>n(o,l,j,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(l)},tasks:{_taskId:e=>{let t="".concat(d,"/").concat(e);return{patch:e=>n(o,t,m,e).json(),$patch:e=>n(o,t,m,e).json().then(e=>e.body),delete:e=>n(o,t,j,e).json(),$delete:e=>n(o,t,j,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(t)}},di:{get:e=>n(o,u,"GET",e).json(),$get:e=>n(o,u,"GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat(u)},get:e=>n(o,d,"GET",e).json(),$get:e=>n(o,d,"GET",e).json().then(e=>e.body),post:e=>n(o,d,g,e).json(),$post:e=>n(o,d,g,e).json().then(e=>e.body),patch:e=>n(o,d,m,e).json(),$patch:e=>n(o,d,m,e).json().then(e=>e.body),delete:e=>n(o,d,j,e).json(),$delete:e=>n(o,d,j,e).json().then(e=>e.body),$path:e=>"".concat(o).concat(d).concat(e&&e.query?"?".concat((0,s._K)(e.query)):"")},test:{get:e=>n(o,h,"GET",e).text(),$get:e=>n(o,h,"GET",e).text().then(e=>e.body),$path:()=>"".concat(o).concat(h)},user:{get:e=>n(o,p,"GET",e).json(),$get:e=>n(o,p,"GET",e).json().then(e=>e.body),post:e=>n(o,p,g,e).send(),$post:e=>n(o,p,g,e).send().then(e=>e.body),$path:e=>"".concat(o).concat(p).concat(e&&e.query?"?".concat((0,s._K)(e.query)):"")},get:e=>n(o,"","GET",e).text(),$get:e=>n(o,"","GET",e).text().then(e=>e.body),$path:()=>"".concat(o)}})((0,o.Z)(a.Z.create({withCredentials:!0})))},6386:function(e,t,n){"use strict";let o;n.d(t,{l:function(){return createAuth}});var s=n(3977),a=n(1259),c=n(3454);let createAuth=()=>{if(void 0!==o)return o;if(void 0!==c.env.NEXT_PUBLIC_AUTH_EMULATOR_URL){console.log("ローカル環境");let e=(0,a.v0)((0,s.ZF)({apiKey:"fake-api-key",authDomain:location.hostname}));return(0,a.S$)(e,c.env.NEXT_PUBLIC_AUTH_EMULATOR_URL,{disableWarnings:!0}),o=e,e}{console.log("本番環境");let e=JSON.parse(""),t=(0,a.v0)((0,s.ZF)(e));return o=t,t}}},6819:function(e,t,n){"use strict";n.d(t,{F:function(){return returnNull}});let returnNull=()=>null},8046:function(e){e.exports={container:"Loading_container__wV1ri",loader:"Loading_loader__cpdbt",load:"Loading_load__8NQtO"}},5293:function(e){e.exports={container:"BasicHeader_container__ASIaK",main:"BasicHeader_main__Vqufr",userBtn:"BasicHeader_userBtn__wlK48",userIcon:"BasicHeader_userIcon__UecGa",userName:"BasicHeader_userName__KiR1h",logoImage:"BasicHeader_logoImage__uFMXP"}}},function(e){e.O(0,[661,583,941,911,664,774,888,179],function(){return e(e.s=3555)}),_N_E=e.O()}]);