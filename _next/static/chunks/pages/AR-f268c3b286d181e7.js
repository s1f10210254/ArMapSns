(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{4747:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AR",function(){return n(1361)}])},3936:function(e,t,n){"use strict";n.d(t,{v:function(){return BasicHeader}});var s=n(5893),a=n(8583),r=n(1163),i=n(6221);let HumanIcon=e=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,fill:e.fill,children:(0,s.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});var o=n(4076),l=n(5293),c=n.n(l);let BasicHeader=e=>{let{user:t}=e,onLogout=async()=>{confirm("Logout?")&&await (0,o.kS)()},n=(0,r.useRouter)(),[l,u]=(0,a.KO)(i.XI),handleChenge=async()=>{l?await n.push("/"):await n.push("/AR"),u(!l)};return(0,s.jsx)("div",{className:c().container,children:(0,s.jsxs)("div",{className:c().main,children:[(0,s.jsx)("h3",{children:"ArMapSNS"}),(0,s.jsxs)("div",{className:c().userBtn,onClick:onLogout,children:[void 0!==t.photoURL?(0,s.jsx)("img",{className:c().userIcon,src:t.photoURL,height:24,alt:t.displayName}):(0,s.jsx)(HumanIcon,{size:18,fill:"#555"}),(0,s.jsx)("span",{className:c().userName,children:t.displayName})]}),(0,s.jsx)("button",{onClick:handleChenge,children:"MAP or AR"})]})})}},1361:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return AR}});var s=n(5893),a=n(8583),r=n(7294),i=n(6221),o=n(9854),l=n(9477);let TextGeometry=class TextGeometry extends l.O7d{constructor(e,t={}){let n=t.font;if(void 0===n)super();else{let s=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(s,t)}this.type="TextGeometry"}};let FontLoader=class FontLoader extends l.aNw{constructor(e){super(e)}load(e,t,n,s){let a=this,r=new l.hH6(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(e){let n=a.parse(JSON.parse(e));t&&t(n)},n,s)}parse(e){return new Font(e)}};let Font=class Font{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){let n=[],s=function(e,t,n){let s=Array.from(e),a=t/n.resolution,r=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*a,i=[],o=0,c=0;for(let e=0;e<s.length;e++){let t=s[e];if("\n"===t)o=0,c-=r;else{let e=function(e,t,n,s,a){let r,i,o,c,u,h,d,f;let m=a.glyphs[e]||a.glyphs["?"];if(!m){console.error('THREE.Font: character "'+e+'" does not exists in font family '+a.familyName+".");return}let p=new l.T_1;if(m.o){let e=m._cachedOutline||(m._cachedOutline=m.o.split(" "));for(let a=0,l=e.length;a<l;){let l=e[a++];switch(l){case"m":r=e[a++]*t+n,i=e[a++]*t+s,p.moveTo(r,i);break;case"l":r=e[a++]*t+n,i=e[a++]*t+s,p.lineTo(r,i);break;case"q":o=e[a++]*t+n,c=e[a++]*t+s,u=e[a++]*t+n,h=e[a++]*t+s,p.quadraticCurveTo(u,h,o,c);break;case"b":o=e[a++]*t+n,c=e[a++]*t+s,u=e[a++]*t+n,h=e[a++]*t+s,d=e[a++]*t+n,f=e[a++]*t+s,p.bezierCurveTo(u,h,d,f,o,c)}}}return{offsetX:m.ha*t,path:p}}(t,a,o,c,n);o+=e.offsetX,i.push(e.path)}}return i}(e,t,this.data);for(let e=0,t=s.length;e<t;e++)n.push(...s[e].toShapes());return n}};var c=n(3936),u=n(3268),h=n.n(u);function AR(){let[e]=(0,a.KO)(i.LF),t=(0,r.useRef)(null),n="お疲れ様ですああああ！";return((0,r.useEffect)(()=>{if(t.current&&0===t.current.children.length){let e=new l.xsS,s=new FontLoader;s.load("/fonts/Noto Sans JP Thin_Regular.json",function(t){let s=new TextGeometry(n,{font:t,size:.2,height:.02,curveSegments:10,bevelEnabled:!0,bevelThickness:.01,bevelSize:.01,bevelSegments:1}),a=new l.vBJ({color:16775408}),r=new l.Kj0(s,a),i=.136*n.length;r.position.set(-i,0,0),e.add(r);let u=.005,animate=()=>{requestAnimationFrame(animate),r.scale.z+=u,(r.scale.z>1||r.scale.z<.1)&&(u*=-1),c.render(e,o)};animate()});let a=t.current.clientWidth,r=t.current.clientHeight,i=a/r,o=new l.cPb(75,i,.1,1e3);o.position.z=1.8;let c=new l.CP7;c.setSize(a,r);let u=t.current;return u.appendChild(c.domElement),()=>{null!==u&&u.removeChild(c.domElement)}}},[]),e)?(0,s.jsxs)("div",{className:h().container,children:[(0,s.jsx)("div",{className:h().headerContainer,children:(0,s.jsx)(c.v,{user:e})}),(0,s.jsx)("div",{className:h().ar,ref:t})]}):(0,s.jsx)(o.g,{visible:!0})}},4076:function(e,t,n){"use strict";n.d(t,{id:function(){return authWithEmail},kS:function(){return logout}});var s=n(4857),a=n(2509),r=n(3483),i=n(6819);let logout=async()=>{await (0,a.l)().signOut()},checkIfNewUser=async e=>{let t=await r.x.user.$get({query:{userID:e}});0===t.length&&await r.x.user.post({body:{userID:e}}).catch(i.F)},authWithEmail=async(e,t)=>{let n=(0,a.l)();try{let a=await (0,s.e5)(n,e,t),r=a.user.uid;await checkIfNewUser(r),console.log("ログイン成功")}catch(a){if("auth/user-not-found"!==a.code)return console.error("ログイン失敗",a),null;try{let a=await (0,s.Xb)(n,e,t),r=a.user.uid;await checkIfNewUser(r),console.log("新規登録成功")}catch(e){return console.log("新規登録失敗",e),null}}}},5293:function(e){e.exports={container:"BasicHeader_container__ASIaK",main:"BasicHeader_main__Vqufr",userBtn:"BasicHeader_userBtn__wlK48",userIcon:"BasicHeader_userIcon__UecGa",userName:"BasicHeader_userName__KiR1h"}},3268:function(e){e.exports={container:"AR_container__rewzQ",headerContainer:"AR_headerContainer__I8Wto",ar:"AR_ar__H0gKt"}}},function(e){e.O(0,[737,774,888,179],function(){return e(e.s=4747)}),_N_E=e.O()}]);