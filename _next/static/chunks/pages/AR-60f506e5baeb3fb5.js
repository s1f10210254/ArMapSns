(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{4747:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AR",function(){return n(7892)}])},7498:function(e,t){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{PrefetchKind:function(){return n},ACTION_REFRESH:function(){return l},ACTION_NAVIGATE:function(){return r},ACTION_RESTORE:function(){return i},ACTION_SERVER_PATCH:function(){return a},ACTION_PREFETCH:function(){return u},ACTION_FAST_REFRESH:function(){return c},ACTION_SERVER_ACTION:function(){return s}});let l="refresh",r="navigate",i="restore",a="server-patch",u="prefetch",c="fast-refresh",s="server-action";(o=n||(n={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},30:function(e,t,n){"use strict";function getDomainLocale(e,t,n,o){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),n(2866),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return b}});let o=n(8754),l=o._(n(7294)),r=n(4450),i=n(2227),a=n(4364),u=n(109),c=n(3607),s=n(1823),d=n(9031),f=n(920),p=n(30),g=n(7192),h=n(7498),y=new Set;function prefetch(e,t,n,o,l,r){if(!r&&!(0,i.isLocalURL)(t))return;if(!o.bypassPrefetchedCheck){let l=void 0!==o.locale?o.locale:"locale"in e?e.locale:void 0,r=t+"%"+n+"%"+l;if(y.has(r))return;y.add(r)}let a=r?e.prefetch(t,l):e.prefetch(t,n,o);Promise.resolve(a).catch(e=>{})}function formatStringOrUrl(e){return"string"==typeof e?e:(0,a.formatUrl)(e)}let v=l.default.forwardRef(function(e,t){let n,o;let{href:a,as:y,children:v,prefetch:b=null,passHref:_,replace:m,shallow:x,scroll:j,locale:E,onClick:O,onMouseEnter:C,onTouchStart:P,legacyBehavior:A=!1,...R}=e;n=v,A&&("string"==typeof n||"number"==typeof n)&&(n=l.default.createElement("a",null,n));let k=l.default.useContext(s.RouterContext),I=l.default.useContext(d.AppRouterContext),T=null!=k?k:I,M=!k,w=!1!==b,L=null===b?h.PrefetchKind.AUTO:h.PrefetchKind.FULL,{href:S,as:N}=l.default.useMemo(()=>{if(!k){let e=formatStringOrUrl(a);return{href:e,as:y?formatStringOrUrl(y):e}}let[e,t]=(0,r.resolveHref)(k,a,!0);return{href:e,as:y?(0,r.resolveHref)(k,y):t||e}},[k,a,y]),F=l.default.useRef(S),U=l.default.useRef(N);A&&(o=l.default.Children.only(n));let K=A?o&&"object"==typeof o&&o.ref:t,[D,H,B]=(0,f.useIntersection)({rootMargin:"200px"}),q=l.default.useCallback(e=>{(U.current!==N||F.current!==S)&&(B(),U.current=N,F.current=S),D(e),K&&("function"==typeof K?K(e):"object"==typeof K&&(K.current=e))},[N,K,S,B,D]);l.default.useEffect(()=>{T&&H&&w&&prefetch(T,S,N,{locale:E},{kind:L},M)},[N,S,H,E,w,null==k?void 0:k.locale,T,M,L]);let G={ref:q,onClick(e){A||"function"!=typeof O||O(e),A&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),T&&!e.defaultPrevented&&function(e,t,n,o,r,a,u,c,s,d){let{nodeName:f}=e.currentTarget,p="A"===f.toUpperCase();if(p&&(function(e){let t=e.currentTarget,n=t.getAttribute("target");return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!s&&!(0,i.isLocalURL)(n)))return;e.preventDefault();let navigate=()=>{let e=null==u||u;"beforePopState"in t?t[r?"replace":"push"](n,o,{shallow:a,locale:c,scroll:e}):t[r?"replace":"push"](o||n,{forceOptimisticNavigation:!d,scroll:e})};s?l.default.startTransition(navigate):navigate()}(e,T,S,N,m,x,j,E,M,w)},onMouseEnter(e){A||"function"!=typeof C||C(e),A&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),T&&(w||!M)&&prefetch(T,S,N,{locale:E,priority:!0,bypassPrefetchedCheck:!0},{kind:L},M)},onTouchStart(e){A||"function"!=typeof P||P(e),A&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),T&&(w||!M)&&prefetch(T,S,N,{locale:E,priority:!0,bypassPrefetchedCheck:!0},{kind:L},M)}};if((0,u.isAbsoluteUrl)(N))G.href=N;else if(!A||_||"a"===o.type&&!("href"in o.props)){let e=void 0!==E?E:null==k?void 0:k.locale,t=(null==k?void 0:k.isLocaleDomain)&&(0,p.getDomainLocale)(N,e,null==k?void 0:k.locales,null==k?void 0:k.domainLocales);G.href=t||(0,g.addBasePath)((0,c.addLocale)(N,e,null==k?void 0:k.defaultLocale))}return A?l.default.cloneElement(o,G):l.default.createElement("a",{...R,...G},n)}),b=v;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},920:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let o=n(7294),l=n(3436),r="function"==typeof IntersectionObserver,i=new Map,a=[];function useIntersection(e){let{rootRef:t,rootMargin:n,disabled:u}=e,c=u||!r,[s,d]=(0,o.useState)(!1),f=(0,o.useRef)(null),p=(0,o.useCallback)(e=>{f.current=e},[]);(0,o.useEffect)(()=>{if(r){if(c||s)return;let e=f.current;if(e&&e.tagName){let o=function(e,t,n){let{id:o,observer:l,elements:r}=function(e){let t;let n={root:e.root||null,margin:e.rootMargin||""},o=a.find(e=>e.root===n.root&&e.margin===n.margin);if(o&&(t=i.get(o)))return t;let l=new Map,r=new IntersectionObserver(e=>{e.forEach(e=>{let t=l.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e);return t={id:n,observer:r,elements:l},a.push(n),i.set(n,t),t}(n);return r.set(e,t),l.observe(e),function(){if(r.delete(e),l.unobserve(e),0===r.size){l.disconnect(),i.delete(o);let e=a.findIndex(e=>e.root===o.root&&e.margin===o.margin);e>-1&&a.splice(e,1)}}}(e,e=>e&&d(e),{root:null==t?void 0:t.current,rootMargin:n});return o}}else if(!s){let e=(0,l.requestIdleCallback)(()=>d(!0));return()=>(0,l.cancelIdleCallback)(e)}},[c,n,t,s,f.current]);let g=(0,o.useCallback)(()=>{d(!1)},[]);return[p,s,g]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7892:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return index_page}});var o=n(5893),l=n(8583),r=n(1664),i=n.n(r),a=n(7294),u=n(6221),c=n(3483),s=n(6819),d=n(5123),f=n.n(d),ar_page=()=>{let[e]=(0,l.KO)(u.LF),[t,n]=(0,l.KO)(u.ge),[r,d]=(0,a.useState)(null),p=(0,a.useCallback)(async()=>{if(null===t.latitude||null===t.longitude)return;let e=t.latitude,n=t.longitude,o=await c.x.posts.$get({query:{latitude:e,longitude:n}}).catch(s.F);d(o),console.log("getPosts")},[t.latitude,t.longitude]);(0,a.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(e=>{n({latitude:e.coords.latitude,longitude:e.coords.longitude})})},[n]);let[g,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(g&&null!==t.latitude&&null!==t.longitude){let oneRendaringGetPosts=async()=>{let e=t.latitude,n=t.longitude,o=await c.x.posts.$get({query:{latitude:e,longitude:n}}).catch(s.F);d(o)};oneRendaringGetPosts(),h(!1)}},[t.latitude,t.longitude,g]);let[y,v]=(0,a.useState)(0);return window.handleLike=async t=>{if((null==e?void 0:e.id)===void 0||void 0===t)return;let n=await c.x.posts.$post({body:{postId:t,userId:e.id}});console.log("result",n),v(n),await p(),console.log("result",n),console.log("likecount",y)},(0,a.useEffect)(()=>{void 0===AFRAME.components["hit-box"]&&AFRAME.registerComponent("hit-box",{schema:{postId:{type:"string"}},init(){this.el.addEventListener("click",()=>{let e=this.data.postId;console.log("postID",e),window.handleLike(e)})}}),void 0===AFRAME.components.log&&AFRAME.registerComponent("log",{schema:{type:"string"},init(){let e=this.data;console.log("log内容",e)}})},[]),(0,o.jsxs)("div",{children:[(0,o.jsx)(i(),{href:"/",children:(0,o.jsx)("button",{className:f().mapButton,children:"MAP"})}),null!==t.latitude&&null!==t.longitude&&(0,o.jsxs)("div",{className:f().coordinatesInfo,children:["Latitude: ",t.latitude,", Longitude: ",t.longitude]}),(0,o.jsxs)("a-scene",{"vr-mode-ui":"enabled: false",arjs:"sourceType: webcam; videoTexture: true; debugUIEnabled: false",renderer:"antialias: true; alpha: true",children:[null==r?void 0:r.map((t,n)=>(0,o.jsxs)("a-entity",{id:"post".concat(n),position:"".concat(2*n," 1 -1"),rotation:"0 0 0",children:[t.id===(null==e?void 0:e.id)?(0,o.jsx)("a-plane",{color:"#b4b9de",height:"1",width:"1.5",position:"0 0 -0.1"}):(0,o.jsx)("a-plane",{color:"#e3e69a",height:"1",width:"1.5",position:"0 0 -0.1"}),(0,o.jsx)("a-plane",{color:"#ffffff",height:"0.5",width:"1",position:"0 0.2 -0.099",align:"center"}),(0,o.jsx)("a-text",{value:t.content,position:"0 0.2 0","gps-entity-place":"latitude: ".concat(t.latitude,"; longitude: ").concat(t.longitude),scale:"0.4 0.4 0.4",color:"black",align:"center"}),(0,o.jsx)("a-entity",{position:"-0.4 -0.3 0","gps-entity-place":"latitude: ".concat(t.latitude,"; longitude: ").concat(t.longitude),"gltf-model":"/models/love_heart.gltf",scale:"0.0008 0.0007 0.0005"}),(0,o.jsx)("a-entity",{position:"-0.4, -0.225 0","hit-box":"postId: ".concat(t.id),children:(0,o.jsx)("a-entity",{class:"raycastable","gps-entity-place":"latitude: ".concat(t.latitude,"; longitude: ").concat(t.longitude),geometry:"primitive:box",material:"color:blue; opacity: 0.5",scale:"0.2 0.2 0.1",position:"0 0 0",visible:"false"})}),(0,o.jsx)("a-text",{value:"Likes: ".concat(t.likeCount),position:"-0.48 -0.1 0","gps-entity-place":"latitude: ".concat(t.latitude,"; longitude: ").concat(t.longitude),scale:"0.2 0.2 0.2",color:"black"}),(0,o.jsx)("a-text",{value:"".concat(t.postTime),position:"0.1 -0.3 0","gps-entity-place":"latitude: ".concat(t.latitude,"; longitude: ").concat(t.longitude),scale:"0.15 0.15 0.15",color:"#373535"})]},n)),(0,o.jsx)("a-camera",{"gps-camera":"maxDistance:20","rotation-reader":!0}),(0,o.jsx)("a-entity",{id:"mouseCursor",cursor:"rayOrigin: mouse",raycaster:"objects: .raycastable"})]})]})},index_page=()=>(0,o.jsx)("div",{children:(0,o.jsx)(ar_page,{})})},5123:function(e){e.exports={mapButton:"ar_mapButton__k_EPZ",coordinatesInfo:"ar_coordinatesInfo__1KWgl"}},1664:function(e,t,n){e.exports=n(5170)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4747)}),_N_E=e.O()}]);