(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{4747:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AR",function(){return n(7892)}])},7498:function(e,t){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{PrefetchKind:function(){return n},ACTION_REFRESH:function(){return l},ACTION_NAVIGATE:function(){return r},ACTION_RESTORE:function(){return a},ACTION_SERVER_PATCH:function(){return i},ACTION_PREFETCH:function(){return u},ACTION_FAST_REFRESH:function(){return c},ACTION_SERVER_ACTION:function(){return s}});let l="refresh",r="navigate",a="restore",i="server-patch",u="prefetch",c="fast-refresh",s="server-action";(o=n||(n={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},30:function(e,t,n){"use strict";function getDomainLocale(e,t,n,o){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),n(2866),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return b}});let o=n(8754),l=o._(n(7294)),r=n(4450),a=n(2227),i=n(4364),u=n(109),c=n(3607),s=n(1823),f=n(9031),d=n(920),p=n(30),g=n(7192),h=n(7498),y=new Set;function prefetch(e,t,n,o,l,r){if(!r&&!(0,a.isLocalURL)(t))return;if(!o.bypassPrefetchedCheck){let l=void 0!==o.locale?o.locale:"locale"in e?e.locale:void 0,r=t+"%"+n+"%"+l;if(y.has(r))return;y.add(r)}let i=r?e.prefetch(t,l):e.prefetch(t,n,o);Promise.resolve(i).catch(e=>{})}function formatStringOrUrl(e){return"string"==typeof e?e:(0,i.formatUrl)(e)}let v=l.default.forwardRef(function(e,t){let n,o;let{href:i,as:y,children:v,prefetch:b=null,passHref:_,replace:m,shallow:x,scroll:j,locale:E,onClick:O,onMouseEnter:C,onTouchStart:P,legacyBehavior:A=!1,...R}=e;n=v,A&&("string"==typeof n||"number"==typeof n)&&(n=l.default.createElement("a",null,n));let T=l.default.useContext(s.RouterContext),k=l.default.useContext(f.AppRouterContext),I=null!=T?T:k,M=!T,L=!1!==b,w=null===b?h.PrefetchKind.AUTO:h.PrefetchKind.FULL,{href:S,as:N}=l.default.useMemo(()=>{if(!T){let e=formatStringOrUrl(i);return{href:e,as:y?formatStringOrUrl(y):e}}let[e,t]=(0,r.resolveHref)(T,i,!0);return{href:e,as:y?(0,r.resolveHref)(T,y):t||e}},[T,i,y]),F=l.default.useRef(S),U=l.default.useRef(N);A&&(o=l.default.Children.only(n));let K=A?o&&"object"==typeof o&&o.ref:t,[D,H,B]=(0,d.useIntersection)({rootMargin:"200px"}),q=l.default.useCallback(e=>{(U.current!==N||F.current!==S)&&(B(),U.current=N,F.current=S),D(e),K&&("function"==typeof K?K(e):"object"==typeof K&&(K.current=e))},[N,K,S,B,D]);l.default.useEffect(()=>{I&&H&&L&&prefetch(I,S,N,{locale:E},{kind:w},M)},[N,S,H,E,L,null==T?void 0:T.locale,I,M,w]);let G={ref:q,onClick(e){A||"function"!=typeof O||O(e),A&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),I&&!e.defaultPrevented&&function(e,t,n,o,r,i,u,c,s,f){let{nodeName:d}=e.currentTarget,p="A"===d.toUpperCase();if(p&&(function(e){let t=e.currentTarget,n=t.getAttribute("target");return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!s&&!(0,a.isLocalURL)(n)))return;e.preventDefault();let navigate=()=>{let e=null==u||u;"beforePopState"in t?t[r?"replace":"push"](n,o,{shallow:i,locale:c,scroll:e}):t[r?"replace":"push"](o||n,{forceOptimisticNavigation:!f,scroll:e})};s?l.default.startTransition(navigate):navigate()}(e,I,S,N,m,x,j,E,M,L)},onMouseEnter(e){A||"function"!=typeof C||C(e),A&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),I&&(L||!M)&&prefetch(I,S,N,{locale:E,priority:!0,bypassPrefetchedCheck:!0},{kind:w},M)},onTouchStart(e){A||"function"!=typeof P||P(e),A&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),I&&(L||!M)&&prefetch(I,S,N,{locale:E,priority:!0,bypassPrefetchedCheck:!0},{kind:w},M)}};if((0,u.isAbsoluteUrl)(N))G.href=N;else if(!A||_||"a"===o.type&&!("href"in o.props)){let e=void 0!==E?E:null==T?void 0:T.locale,t=(null==T?void 0:T.isLocaleDomain)&&(0,p.getDomainLocale)(N,e,null==T?void 0:T.locales,null==T?void 0:T.domainLocales);G.href=t||(0,g.addBasePath)((0,c.addLocale)(N,e,null==T?void 0:T.defaultLocale))}return A?l.default.cloneElement(o,G):l.default.createElement("a",{...R,...G},n)}),b=v;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},920:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let o=n(7294),l=n(3436),r="function"==typeof IntersectionObserver,a=new Map,i=[];function useIntersection(e){let{rootRef:t,rootMargin:n,disabled:u}=e,c=u||!r,[s,f]=(0,o.useState)(!1),d=(0,o.useRef)(null),p=(0,o.useCallback)(e=>{d.current=e},[]);(0,o.useEffect)(()=>{if(r){if(c||s)return;let e=d.current;if(e&&e.tagName){let o=function(e,t,n){let{id:o,observer:l,elements:r}=function(e){let t;let n={root:e.root||null,margin:e.rootMargin||""},o=i.find(e=>e.root===n.root&&e.margin===n.margin);if(o&&(t=a.get(o)))return t;let l=new Map,r=new IntersectionObserver(e=>{e.forEach(e=>{let t=l.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e);return t={id:n,observer:r,elements:l},i.push(n),a.set(n,t),t}(n);return r.set(e,t),l.observe(e),function(){if(r.delete(e),l.unobserve(e),0===r.size){l.disconnect(),a.delete(o);let e=i.findIndex(e=>e.root===o.root&&e.margin===o.margin);e>-1&&i.splice(e,1)}}}(e,e=>e&&f(e),{root:null==t?void 0:t.current,rootMargin:n});return o}}else if(!s){let e=(0,l.requestIdleCallback)(()=>f(!0));return()=>(0,l.cancelIdleCallback)(e)}},[c,n,t,s,d.current]);let g=(0,o.useCallback)(()=>{f(!1)},[]);return[p,s,g]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7892:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return index_page}});var o=n(5893),l=n(8583),r=n(1664),a=n.n(r),i=n(7294),u=n(6221),c=n(3483),s=n(6819),f=n(5123),d=n.n(f),ar_page=()=>{let[e]=(0,l.KO)(u.LF),[t,n]=(0,l.KO)(u.ge),[r,f]=(0,i.useState)(null),p=(0,i.useCallback)(async()=>{if(null===t.latitude||null===t.longitude)return;let e=t.latitude,n=t.longitude,o=await c.x.posts.$get({query:{latitude:e,longitude:n}}).catch(s.F);f(o),console.log("getPosts")},[t.latitude,t.longitude]);(0,i.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(e=>{n({latitude:e.coords.latitude,longitude:e.coords.longitude})})},[n]);let[g,h]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(g&&null!==t.latitude&&null!==t.longitude){let oneRendaringGetPosts=async()=>{let e=t.latitude,n=t.longitude,o=await c.x.posts.$get({query:{latitude:e,longitude:n}}).catch(s.F);f(o)};oneRendaringGetPosts(),h(!1)}},[t.latitude,t.longitude,g]);let[y,v]=(0,i.useState)(0),b=(0,i.useCallback)(async t=>{if((null==e?void 0:e.id)===void 0||void 0===t)return;let n=await c.x.posts.$post({body:{postId:t,userId:e.id}});console.log("result",n),v(n),await p(),console.log("result",n),console.log("likecount",y)},[p,y,null==e?void 0:e.id]);return(0,i.useEffect)(()=>{void 0===AFRAME.components["hit-box"]&&AFRAME.registerComponent("hit-box",{schema:{postId:{type:"string"}},init(){this.el.addEventListener("click",()=>{let e=this.postId;console.log("postId",e),b(e),console.log("オブジェクトがクリックされました")})}}),void 0===AFRAME.components.log&&AFRAME.registerComponent("log",{schema:{type:"string"},init(){let e=this.data;console.log("log内容",e)}})},[b]),(0,o.jsxs)("div",{children:[(0,o.jsx)(a(),{href:"/",children:(0,o.jsx)("button",{className:d().mapButton,children:"MAP"})}),null!==t.latitude&&null!==t.longitude&&(0,o.jsxs)("div",{className:d().coordinatesInfo,children:["Latitude: ",t.latitude,", Longitude: ",t.longitude]}),(0,o.jsxs)("a-scene",{"vr-mode-ui":"enabled: false",arjs:"sourceType: webcam; videoTexture: true; debugUIEnabled: false",renderer:"antialias: true; alpha: true",children:[null==r?void 0:r.map((e,t)=>(0,o.jsxs)("a-entity",{id:"post".concat(t),position:"".concat(2*t," 1 -1"),rotation:"0 0 0",children:[(0,o.jsx)("a-plane",{color:"#e3e69a",height:"1",width:"1.5",position:"0 0 -0.1"}),(0,o.jsx)("a-plane",{color:"#ffffff",height:"0.5",width:"1",position:"0 0.2 -0.099",align:"center"}),(0,o.jsx)("a-text",{value:e.content,position:"0 0.2 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.4 0.4 0.4",color:"black",align:"center"}),(0,o.jsx)("a-entity",{position:"-0.4 -0.3 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),"gltf-model":"/models/love_heart.gltf",scale:"0.0008 0.0007 0.0005"}),(0,o.jsx)("a-entity",{position:"-0.4, -0.225 0","data-post-id":e.id,"hit-box":!0,children:(0,o.jsx)("a-entity",{class:"raycastable","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),geometry:"primitive:box",material:"color:blue; opacity: 0.5",scale:"0.2 0.2 0.1",position:"0 0 0",visible:"false"})}),(0,o.jsx)("a-text",{value:"Likes: ".concat(e.likeCount),position:"-0.48 -0.1 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.2 0.2 0.2",color:"black"}),(0,o.jsx)("a-text",{value:"".concat(e.postTime),position:"0.1 -0.3 0","gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.15 0.15 0.15",color:"#373535"})]},t)),(0,o.jsx)("a-camera",{"gps-camera":"maxDistance:20","rotation-reader":!0}),(0,o.jsx)("a-entity",{id:"mouseCursor",cursor:"rayOrigin: mouse",raycaster:"objects: .raycastable"})]})]})},index_page=()=>(0,o.jsx)("div",{children:(0,o.jsx)(ar_page,{})})},5123:function(e){e.exports={mapButton:"ar_mapButton__k_EPZ",coordinatesInfo:"ar_coordinatesInfo__1KWgl"}},1664:function(e,t,n){e.exports=n(5170)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4747)}),_N_E=e.O()}]);