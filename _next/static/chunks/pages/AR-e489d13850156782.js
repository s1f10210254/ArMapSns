(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{4747:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AR",function(){return n(7892)}])},7498:function(e,t){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{PrefetchKind:function(){return n},ACTION_REFRESH:function(){return r},ACTION_NAVIGATE:function(){return l},ACTION_RESTORE:function(){return a},ACTION_SERVER_PATCH:function(){return u},ACTION_PREFETCH:function(){return i},ACTION_FAST_REFRESH:function(){return c},ACTION_SERVER_ACTION:function(){return s}});let r="refresh",l="navigate",a="restore",u="server-patch",i="prefetch",c="fast-refresh",s="server-action";(o=n||(n={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},30:function(e,t,n){"use strict";function getDomainLocale(e,t,n,o){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),n(2866),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return y}});let o=n(8754),r=o._(n(7294)),l=n(4450),a=n(2227),u=n(4364),i=n(109),c=n(3607),s=n(1823),f=n(9031),d=n(920),p=n(30),g=n(7192),h=n(7498),v=new Set;function prefetch(e,t,n,o,r,l){if(!l&&!(0,a.isLocalURL)(t))return;if(!o.bypassPrefetchedCheck){let r=void 0!==o.locale?o.locale:"locale"in e?e.locale:void 0,l=t+"%"+n+"%"+r;if(v.has(l))return;v.add(l)}let u=l?e.prefetch(t,r):e.prefetch(t,n,o);Promise.resolve(u).catch(e=>{})}function formatStringOrUrl(e){return"string"==typeof e?e:(0,u.formatUrl)(e)}let _=r.default.forwardRef(function(e,t){let n,o;let{href:u,as:v,children:_,prefetch:y=null,passHref:b,replace:m,shallow:E,scroll:j,locale:O,onClick:x,onMouseEnter:P,onTouchStart:C,legacyBehavior:A=!1,...R}=e;n=_,A&&("string"==typeof n||"number"==typeof n)&&(n=r.default.createElement("a",null,n));let k=r.default.useContext(s.RouterContext),M=r.default.useContext(f.AppRouterContext),T=null!=k?k:M,I=!k,L=!1!==y,S=null===y?h.PrefetchKind.AUTO:h.PrefetchKind.FULL,{href:N,as:w}=r.default.useMemo(()=>{if(!k){let e=formatStringOrUrl(u);return{href:e,as:v?formatStringOrUrl(v):e}}let[e,t]=(0,l.resolveHref)(k,u,!0);return{href:e,as:v?(0,l.resolveHref)(k,v):t||e}},[k,u,v]),U=r.default.useRef(N),F=r.default.useRef(w);A&&(o=r.default.Children.only(n));let D=A?o&&"object"==typeof o&&o.ref:t,[K,H,B]=(0,d.useIntersection)({rootMargin:"200px"}),q=r.default.useCallback(e=>{(F.current!==w||U.current!==N)&&(B(),F.current=w,U.current=N),K(e),D&&("function"==typeof D?D(e):"object"==typeof D&&(D.current=e))},[w,D,N,B,K]);r.default.useEffect(()=>{T&&H&&L&&prefetch(T,N,w,{locale:O},{kind:S},I)},[w,N,H,O,L,null==k?void 0:k.locale,T,I,S]);let G={ref:q,onClick(e){A||"function"!=typeof x||x(e),A&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),T&&!e.defaultPrevented&&function(e,t,n,o,l,u,i,c,s,f){let{nodeName:d}=e.currentTarget,p="A"===d.toUpperCase();if(p&&(function(e){let t=e.currentTarget,n=t.getAttribute("target");return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!s&&!(0,a.isLocalURL)(n)))return;e.preventDefault();let navigate=()=>{let e=null==i||i;"beforePopState"in t?t[l?"replace":"push"](n,o,{shallow:u,locale:c,scroll:e}):t[l?"replace":"push"](o||n,{forceOptimisticNavigation:!f,scroll:e})};s?r.default.startTransition(navigate):navigate()}(e,T,N,w,m,E,j,O,I,L)},onMouseEnter(e){A||"function"!=typeof P||P(e),A&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),T&&(L||!I)&&prefetch(T,N,w,{locale:O,priority:!0,bypassPrefetchedCheck:!0},{kind:S},I)},onTouchStart(e){A||"function"!=typeof C||C(e),A&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),T&&(L||!I)&&prefetch(T,N,w,{locale:O,priority:!0,bypassPrefetchedCheck:!0},{kind:S},I)}};if((0,i.isAbsoluteUrl)(w))G.href=w;else if(!A||b||"a"===o.type&&!("href"in o.props)){let e=void 0!==O?O:null==k?void 0:k.locale,t=(null==k?void 0:k.isLocaleDomain)&&(0,p.getDomainLocale)(w,e,null==k?void 0:k.locales,null==k?void 0:k.domainLocales);G.href=t||(0,g.addBasePath)((0,c.addLocale)(w,e,null==k?void 0:k.defaultLocale))}return A?r.default.cloneElement(o,G):r.default.createElement("a",{...R,...G},n)}),y=_;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},920:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let o=n(7294),r=n(3436),l="function"==typeof IntersectionObserver,a=new Map,u=[];function useIntersection(e){let{rootRef:t,rootMargin:n,disabled:i}=e,c=i||!l,[s,f]=(0,o.useState)(!1),d=(0,o.useRef)(null),p=(0,o.useCallback)(e=>{d.current=e},[]);(0,o.useEffect)(()=>{if(l){if(c||s)return;let e=d.current;if(e&&e.tagName){let o=function(e,t,n){let{id:o,observer:r,elements:l}=function(e){let t;let n={root:e.root||null,margin:e.rootMargin||""},o=u.find(e=>e.root===n.root&&e.margin===n.margin);if(o&&(t=a.get(o)))return t;let r=new Map,l=new IntersectionObserver(e=>{e.forEach(e=>{let t=r.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e);return t={id:n,observer:l,elements:r},u.push(n),a.set(n,t),t}(n);return l.set(e,t),r.observe(e),function(){if(l.delete(e),r.unobserve(e),0===l.size){r.disconnect(),a.delete(o);let e=u.findIndex(e=>e.root===o.root&&e.margin===o.margin);e>-1&&u.splice(e,1)}}}(e,e=>e&&f(e),{root:null==t?void 0:t.current,rootMargin:n});return o}}else if(!s){let e=(0,r.requestIdleCallback)(()=>f(!0));return()=>(0,r.cancelIdleCallback)(e)}},[c,n,t,s,d.current]);let g=(0,o.useCallback)(()=>{f(!1)},[]);return[p,s,g]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7892:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return index_page}});var o=n(5893),r=n(8583),l=n(1664),a=n.n(l),u=n(7294),i=n(6221),c=n(3483),s=n(6819),f=n(5123),d=n.n(f),ar_page=()=>{let[e,t]=(0,r.KO)(i.ge),[n,l]=(0,u.useState)(null);(0,u.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(e=>{t({latitude:e.coords.latitude,longitude:e.coords.longitude})})},[t]);let[f,p]=(0,u.useState)(!0);(0,u.useEffect)(()=>{if(f&&null!==e.latitude&&null!==e.longitude){let oneRendaringGetPosts=async()=>{let t=e.latitude,n=e.longitude,o=await c.x.posts.$get({query:{latitude:t,longitude:n}}).catch(s.F);l(o)};oneRendaringGetPosts(),p(!1)}},[e.latitude,e.longitude,f]),(0,u.useEffect)(()=>{void 0===AFRAME.components["hit-box"]&&AFRAME.registerComponent("hit-box",{init(){this.el.addEventListener("click",()=>{alert("clickしました"),console.log("オブジェクトがクリックされました")})}}),void 0===AFRAME.components.log&&AFRAME.registerComponent("log",{schema:{type:"string"},init(){let e=this.data;console.log("log内容",e)}})},[]);let[g,h]=(0,u.useState)([]),updateDistance=(e,t)=>{h(n=>{let o=[...n];return o[e]={...o[e],distance:t},console.log("newPosts",o),o})};return(0,u.useEffect)(()=>{null==n||n.forEach((e,t)=>{let n=document.querySelector("#post".concat(t));null==n||n.addEventListener("gps-entity-place-update-distance",e=>{updateDistance(t,e.detail.distance)})})},[n]),(0,u.useEffect)(()=>{console.log("Updated postWithDistance",g)},[g]),(0,u.useEffect)(()=>{n&&h(n.map(e=>({...e,distance:0})))},[n]),(0,o.jsxs)("div",{children:[(0,o.jsx)(a(),{href:"/",children:(0,o.jsx)("button",{className:d().mapButton,children:"MAP"})}),null!==e.latitude&&null!==e.longitude&&(0,o.jsxs)("div",{className:d().coordinatesInfo,children:["Latitude: ",e.latitude,", Longitude: ",e.longitude]}),(0,o.jsxs)("a-scene",{"vr-mode-ui":"enabled: false",arjs:"sourceType: webcam; videoTexture: true; debugUIEnabled: false",renderer:"antialias: true; alpha: true",children:[null==n?void 0:n.map((e,t)=>(0,o.jsxs)("a-entity",{id:"post".concat(t),position:"0 ".concat(1.6+.5*t," -1"),rotation:"0 0 0",children:[(0,o.jsx)("a-text",{value:e.content,"gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),scale:"0.5 0.5 0.5","looc-at":"camera",color:"black"}),(0,o.jsx)("a-entity",{"gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),position:"0.5 0 0",scale:"0.0005 0.0005 0.0005","gltf-model":"/models/love_heart.gltf"}),(0,o.jsx)("a-text",{value:"Likes: ".concat(e.likeCount),"gps-entity-place":"latitude: ".concat(e.latitude,"; longitude: ").concat(e.longitude),position:"1 0 0",scale:"0.2 0.2 0.2","look-at":"[gps-camra]",color:"black"})]},t)),g.map((e,t)=>(0,o.jsx)("a-entity",{id:"posts".concat(t),children:(0,o.jsx)("a-text",{value:"Distance: ".concat(e.distance.toFixed(2)," m"),scale:"1 1 1",position:"0 1.6 -1","look-at":"[gps-camera]",align:"center"})},t)),(0,o.jsx)("a-camera",{"gps-camera":!0,"rotation-render":!0})]})]})},index_page=()=>(0,o.jsx)("div",{children:(0,o.jsx)(ar_page,{})})},5123:function(e){e.exports={mapButton:"ar_mapButton__k_EPZ",coordinatesInfo:"ar_coordinatesInfo__1KWgl"}},1664:function(e,t,n){e.exports=n(5170)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=4747)}),_N_E=e.O()}]);