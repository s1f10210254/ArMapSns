(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{6111:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var o=r(n(4938)),a=n(5893),i=(0,o.default)((0,a.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");t.Z=i},1898:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var o=r(n(4938)),a=n(5893),i=(0,o.default)([(0,a.jsx)("path",{d:"M17 19.22H5V7h7V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-7h-2v7.22z"},"0"),(0,a.jsx)("path",{d:"M19 2h-2v3h-3c.01.01 0 2 0 2h3v2.99c.01.01 2 0 2 0V7h3V5h-3V2zM7 9h8v2H7zm0 3v2h8v-2h-3zm0 3h8v2H7z"},"1")],"PostAdd");t.Z=i},7878:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var o=r(n(4938)),a=n(5893),i=(0,o.default)((0,a.jsx)("path",{d:"M7.53 21.48C4.26 19.94 1.92 16.76 1.56 13H.06c.51 6.16 5.66 11 11.95 11l.66-.03-3.81-3.81-1.33 1.32zm.89-6.52c-.19 0-.37-.03-.52-.08-.16-.06-.29-.13-.4-.24-.11-.1-.2-.22-.26-.37-.06-.14-.09-.3-.09-.47h-1.3c0 .36.07.68.21.95.14.27.33.5.56.69.24.18.51.32.82.41.3.1.62.15.96.15.37 0 .72-.05 1.03-.15.32-.1.6-.25.83-.44s.42-.43.55-.72.2-.61.2-.97c0-.19-.02-.38-.07-.56-.05-.18-.12-.35-.23-.51-.1-.16-.24-.3-.4-.43-.17-.13-.37-.23-.61-.31.2-.09.37-.2.52-.33.15-.13.27-.27.37-.42.1-.15.17-.3.22-.46s.07-.32.07-.48c0-.36-.06-.68-.18-.96s-.29-.51-.51-.69c-.2-.19-.47-.33-.77-.43C9.11 8.05 8.77 8 8.4 8c-.36 0-.69.05-1 .16-.3.11-.57.26-.79.45-.21.19-.38.41-.51.67-.12.26-.18.54-.18.85h1.3c0-.17.03-.32.09-.45s.14-.25.25-.34.23-.17.38-.22.3-.08.48-.08c.4 0 .7.1.89.31.19.2.29.49.29.86 0 .18-.03.34-.08.49s-.14.27-.25.37c-.11.1-.25.18-.41.24-.16.06-.36.09-.58.09h-.77v1.03h.77c.22 0 .42.02.6.07s.33.13.45.23c.12.11.22.24.29.4s.1.35.1.57c0 .41-.12.72-.35.93-.23.23-.55.33-.95.33zm8.55-5.92c-.32-.33-.7-.59-1.14-.77-.44-.18-.93-.27-1.47-.27H12v8h2.3c.55 0 1.06-.09 1.51-.27s.84-.43 1.16-.76c.32-.33.57-.73.74-1.19.17-.47.26-.99.26-1.57v-.4c0-.58-.09-1.1-.26-1.57s-.42-.87-.74-1.2zm-.39 3.16c0 .42-.05.79-.14 1.13-.1.33-.24.62-.43.85-.19.23-.43.41-.71.53-.29.12-.62.18-.99.18h-.91V9.12h.97c.72 0 1.27.23 1.64.69.38.46.57 1.12.57 1.99v.4zM12.01 0l-.66.03 3.81 3.81 1.33-1.33c3.27 1.55 5.61 4.72 5.96 8.48h1.5C23.45 4.84 18.3 0 12.01 0z"}),"ThreeDRotationTwoTone");t.Z=i},4938:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(3875)},3875:function(e,t,n){"use strict";n.r(t),n.d(t,{capitalize:function(){return o.Z},createChainedFunction:function(){return a},createSvgIcon:function(){return i.Z},debounce:function(){return l.Z},deprecatedPropType:function(){return utils_deprecatedPropType},isMuiElement:function(){return u.Z},ownerDocument:function(){return s.Z},ownerWindow:function(){return c.Z},requirePropFactory:function(){return utils_requirePropFactory},setRef:function(){return d},unstable_ClassNameGenerator:function(){return x},unstable_useEnhancedEffect:function(){return p.Z},unstable_useId:function(){return f},unsupportedProp:function(){return utils_unsupportedProp},useControlled:function(){return h.Z},useEventCallback:function(){return m.Z},useForkRef:function(){return v.Z},useIsFocusVisible:function(){return g.Z}});var r=n(7078),o=n(8216),a=n(9064).Z,i=n(8169),l=n(7144),utils_deprecatedPropType=function(e,t){return()=>null},u=n(1579),s=n(8038),c=n(5340);n(7462);var utils_requirePropFactory=function(e,t){return()=>null},d=n(7960).Z,p=n(8974),f=n(2996).Z,utils_unsupportedProp=function(e,t,n,r,o){return null},h=n(2021),m=n(2068),v=n(1705),g=n(8791);let x={configure:e=>{r.Z.configure(e)}}},778:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return map_page}});var r=n(5893),o=n(6111),a=n(1898),i=n(4238),l=n(9417),u=n(3366),s=n(7462),c=n(7294),d=n(512),p=n(4780),f=n(7739),h=n(8216),m=n(7623),v=n(1588),g=n(4867);function getFabUtilityClass(e){return(0,g.Z)("MuiFab",e)}let x=(0,v.Z)("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]);var b=n(1496);let y=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],useUtilityClasses=e=>{let{color:t,variant:n,classes:r,size:o}=e,a={root:["root",n,`size${(0,h.Z)(o)}`,"inherit"===t?"colorInherit":t]},i=(0,p.Z)(a,getFabUtilityClass,r);return(0,s.Z)({},r,i)},_=(0,b.ZP)(f.Z,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>(0,b.FO)(e)||"classes"===e,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.variant],t[`size${(0,h.Z)(n.size)}`],"inherit"===n.color&&t.colorInherit,t[(0,h.Z)(n.size)],t[n.color]]}})(({theme:e,ownerState:t})=>{var n,r;return(0,s.Z)({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:null==(n=(r=e.palette).getContrastText)?void 0:n.call(r,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${x.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},"small"===t.size&&{width:40,height:40},"medium"===t.size&&{width:48,height:48},"extended"===t.variant&&{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},"extended"===t.variant&&"small"===t.size&&{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"extended"===t.variant&&"medium"===t.size&&{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40},"inherit"===t.color&&{color:"inherit"})},({theme:e,ownerState:t})=>(0,s.Z)({},"inherit"!==t.color&&"default"!==t.color&&null!=(e.vars||e).palette[t.color]&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}}),({theme:e})=>({[`&.${x.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}})),w=c.forwardRef(function(e,t){let n=(0,m.Z)({props:e,name:"MuiFab"}),{children:o,className:a,color:i="default",component:l="button",disabled:c=!1,disableFocusRipple:p=!1,focusVisibleClassName:f,size:h="large",variant:v="circular"}=n,g=(0,u.Z)(n,y),x=(0,s.Z)({},n,{color:i,component:l,disabled:c,disableFocusRipple:p,size:h,variant:v}),b=useUtilityClasses(x);return(0,r.jsx)(_,(0,s.Z)({className:(0,d.Z)(b.root,a),component:l,disabled:c,focusRipple:!p,focusVisibleClassName:(0,d.Z)(b.focusVisible,f),ownerState:x,ref:t},g,{classes:b,children:o}))});var C=n(8583),j=n(5243),z=n.n(j);n(6904);var Z={src:"/ArMapSns/_next/static/media/me.178bc37f.png"};let P=(0,c.createContext)(null),k=P.Provider;function useLeafletContext(){let e=(0,c.useContext)(P);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let I=(0,c.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:o,id:a,placeholder:i,style:l,whenReady:u,zoom:s,...d},p){let[f]=(0,c.useState)({className:o,id:a,style:l}),[h,m]=(0,c.useState)(null);(0,c.useImperativeHandle)(p,()=>h?.map??null,[h]);let v=(0,c.useCallback)(r=>{if(null!==r&&null===h){let o=new j.Map(r,d);null!=n&&null!=s?o.setView(n,s):null!=e&&o.fitBounds(e,t),null!=u&&o.whenReady(u),m(Object.freeze({__version:1,map:o}))}},[]);(0,c.useEffect)(()=>()=>{h?.map.remove()},[h]);let g=h?c.createElement(k,{value:h},r):i??null;return c.createElement("div",_extends({},f,{ref:v}),g)});var H=n(3935);function element_createElementObject(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function element_createElementHook(e,t){return null==t?function(t,n){let r=(0,c.useRef)();return r.current||(r.current=e(t,n)),r}:function(n,r){let o=(0,c.useRef)();o.current||(o.current=e(n,r));let a=(0,c.useRef)(n),{instance:i}=o.current;return(0,c.useEffect)(function(){a.current!==n&&(t(i,n,a.current),a.current=n)},[i,n,r]),o}}function useAttribution(e,t){let n=(0,c.useRef)(t);(0,c.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}function useEventHandlers(e,t){let n=(0,c.useRef)();(0,c.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function withPane(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function createLayerHook(e){return function(t){var n;let r=useLeafletContext(),o=e(withPane(t,r),r);return useAttribution(r.map,t.attribution),useEventHandlers(o.current,t.eventHandlers),n=o.current,(0,c.useEffect)(function(){let e=r.layerContainer??r.map;return e.addLayer(n.instance),function(){r.layerContainer?.removeLayer(n.instance),r.map.removeLayer(n.instance)}},[r,n]),o}}let E=function(e,t){let n=element_createElementHook(e,t),r=createLayerHook(n);return(0,c.forwardRef)(function(e,t){let{instance:n}=r(e).current;return(0,c.useImperativeHandle)(t,()=>n),null})}(function({url:e,...t},n){let r=new j.TileLayer(e,withPane(t,n));return element_createElementObject(r,n)},function(e,t,n){!function(e,t,n){let{opacity:r,zIndex:o}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=o&&o!==n.zIndex&&e.setZIndex(o)}(e,t,n);let{url:r}=t;null!=r&&r!==n.url&&e.setUrl(r)}),N=function(e,t){let n=element_createElementHook(e,t),r=createLayerHook(n);return(0,c.forwardRef)(function(e,t){let{instance:n,context:o}=r(e).current;return(0,c.useImperativeHandle)(t,()=>n),null==e.children?null:c.createElement(k,{value:o},e.children)})}(function({position:e,...t},n){let r=new j.Marker(e,t);return element_createElementObject(r,Object.freeze({...n,overlayContainer:r}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),S=function(e,t){var n;let r=element_createElementHook(e);return n=function(e,n){let o=useLeafletContext(),a=r(withPane(e,o),o);return useAttribution(o.map,e.attribution),useEventHandlers(a.current,e.eventHandlers),t(a.current,o,e,n),a},(0,c.forwardRef)(function(e,t){let[r,o]=(0,c.useState)(!1),{instance:a}=n(e,o).current;(0,c.useImperativeHandle)(t,()=>a),(0,c.useEffect)(function(){r&&a.update()},[a,r,e.children]);let i=a._contentNode;return i?(0,H.createPortal)(e.children,i):null})}(function(e,t){let n=new j.Popup(e,t.overlayContainer);return element_createElementObject(n,t)},function(e,t,{position:n},r){(0,c.useEffect)(function(){let{instance:o}=e;function onPopupOpen(e){e.popup===o&&(o.update(),r(!0))}function onPopupClose(e){e.popup===o&&r(!1)}return t.map.on({popupopen:onPopupOpen,popupclose:onPopupClose}),null==t.overlayContainer?(null!=n&&o.setLatLng(n),o.openOn(t.map)):t.overlayContainer.bindPopup(o),function(){t.map.off({popupopen:onPopupOpen,popupclose:onPopupClose}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(o)}},[e,t,r,n])});var O=n(6221),L=n(9854),R=n(4736),M=n(3483),B=n(6819),F=n(8041),V=n.n(F);z().Icon.Default.mergeOptions({iconRetinaUrl:Z.src,iconSize:[48,48]});let U=z().icon({iconUrl:Z.src,iconSize:[48,48]}),A=z().icon({iconUrl:"/ArMapSns/_next/static/media/other.a347bcce.png",iconSize:[48,48]}),T=z().icon({iconUrl:"/ArMapSns/_next/static/media/pingu.4dc5b828.png",iconSize:[48,48]}),LocationMarker=e=>{let{coordinates:t}=e,n=useLeafletContext().map;return(0,c.useEffect)(()=>{null!==t.latitude&&null!==t.longitude&&n.setView([t.latitude,t.longitude],n.getZoom())},[t,n]),null};var map_page=()=>{let[e]=(0,C.KO)(O.L),[t,n]=(0,C.KO)(O.g);(0,c.useEffect)(()=>{"undefined"!=typeof navigator&&null!==navigator.geolocation&&navigator.geolocation.watchPosition(e=>{n({latitude:e.coords.latitude,longitude:e.coords.longitude})})},[n]);let[u,s]=(0,c.useState)(!1),handleClosePopup=()=>{s(!1)},[d,p]=(0,c.useState)(null),f=(0,c.useCallback)(async()=>{if(null===t.latitude||null===t.longitude)return;let e=t.latitude,n=t.longitude,r=await M.x.posts.$get({query:{latitude:e,longitude:n}}).catch(B.F);p(r),console.log("getPosts")},[t.latitude,t.longitude]),[h,m]=(0,c.useState)(""),postPostContent=async()=>{if((null==e?void 0:e.id)===void 0||""===h||null===t.latitude||null===t.longitude)return;let n=t.latitude,r=t.longitude;await M.x.myPost.$post({body:{username:"aaa",content:h,latitude:n,longitude:r,userID:e.id}}),m(""),handleClosePopup(),f()},[v,g]=(0,c.useState)(0),handleLike=async t=>{if((null==e?void 0:e.id)===void 0||void 0===t)return;let n=await M.x.posts.$post({body:{postId:t,userId:e.id}});g(n),await f(),console.log("result",n),console.log("likecount",v)},[x,b]=(0,c.useState)(!0);(0,c.useEffect)(()=>{if(x&&null!==t.latitude&&null!==t.longitude){let oneRendaringGetPosts=async()=>{let e=t.latitude,n=t.longitude,r=await M.x.posts.$get({query:{latitude:e,longitude:n}}).catch(B.F);p(r)};oneRendaringGetPosts(),b(!1)}},[t.latitude,t.longitude,x]);let formatTime=e=>{let t=new Date(e);return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(t)};return e?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:V().container,children:[(0,r.jsx)(R.v,{user:e}),null!==t.latitude&&null!==t.longitude&&(0,r.jsx)("div",{className:"".concat(V().mapWrapper," ").concat(u?V().blurred:""),children:(0,r.jsxs)(I,{center:[t.latitude,t.longitude],zoom:17,scrollWheelZoom:!1,style:{height:"93vh",width:"100%"},children:[(0,r.jsx)(E,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,r.jsx)(LocationMarker,{coordinates:t}),(0,r.jsx)(N,{position:[t.latitude,t.longitude],icon:T}),null==d?void 0:d.map(t=>(0,r.jsx)(N,{icon:e.id===t.userID?U:A,position:[t.latitude,t.longitude],children:(0,r.jsx)(S,{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"200px",width:"300px"},children:[(0,r.jsx)("div",{style:{fontSize:"18px",marginBottom:"auto",overflow:"auto"},children:t.content}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"end"},children:[(0,r.jsx)(w,{size:"small",color:"secondary","aria-label":"like",onClick:()=>handleLike(t.id),style:{flexGrow:0},children:(0,r.jsx)(o.Z,{})}),(0,r.jsxs)("span",{children:[t.likeCount,"いいね"]}),(0,r.jsx)("div",{style:{fontSize:"10px"},children:formatTime(t.postTime)})]})]})})},t.id))]})})]}),!u&&(0,r.jsxs)("div",{className:V().nearInfo,children:["近くに",(0,r.jsx)("span",{className:V().infoNumber,children:d?d.length:0}),"件の投稿があります"]}),!u&&(0,r.jsx)(w,{className:V().postButton,onClick:()=>{s(!0)},style:{backgroundColor:"#90caf9",width:"80px",height:"80px",position:"absolute",top:"90vh",left:"50vw",transform:"translate(-50%, -50%)"},color:"primary",children:(0,r.jsx)(a.Z,{sx:{fontSize:50,color:"black"}})}),u&&(0,r.jsx)("div",{className:V().popup,children:(0,r.jsxs)("div",{className:V().popupContent,children:[(0,r.jsx)(i.Z,{label:"いまなにしてる？",value:h,onChange:e=>m(e.target.value),InputProps:{endAdornment:(0,r.jsx)("div",{className:V().sendButton,children:(0,r.jsx)(l.Z,{onClick:postPostContent,disabled:!h.trim(),children:"投稿する"})})}}),(0,r.jsx)("button",{onClick:handleClosePopup,children:"戻る"})]})})]}):(0,r.jsx)(L.g,{visible:!0})}},4736:function(e,t,n){"use strict";n.d(t,{v:function(){return BasicHeader}});var r=n(5893),o=n(7878),a=n(1664),i=n.n(a);let HumanIcon=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,fill:e.fill,children:(0,r.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});n(4857);var l=n(2509);n(3483);let logout=async()=>{await (0,l.l)().signOut()};var u=n(5293),s=n.n(u);let BasicHeader=e=>{let{user:t}=e,onLogout=async()=>{confirm("Logout?")&&await logout()};return(0,r.jsx)("div",{className:s().container,children:(0,r.jsxs)("div",{className:s().main,children:[(0,r.jsx)("h3",{children:"ArMapSNS"}),(0,r.jsxs)("div",{className:s().userBtn,onClick:onLogout,children:[void 0!==t.photoURL?(0,r.jsx)("img",{className:s().userIcon,src:t.photoURL,height:24,alt:t.displayName}):(0,r.jsx)(HumanIcon,{size:18,fill:"#555"}),(0,r.jsx)("span",{className:s().userName,children:t.displayName})]}),(0,r.jsx)(i(),{href:"/AR",children:(0,r.jsx)(o.Z,{fontSize:"large"})})]})})}},6904:function(){},8041:function(e){e.exports={container:"map_container__Oqp4f",mapWrapper:"map_mapWrapper__1_3pi",blurred:"map_blurred__c4Upe",postButton:"map_postButton__J5imn",popup:"map_popup__I387y",popupContent:"map_popupContent__QJI8d",sendButton:"map_sendButton__aVyVz",nearInfo:"map_nearInfo__GUsCz",infoNumber:"map_infoNumber__5jGUy"}},5293:function(e){e.exports={container:"BasicHeader_container__ASIaK",main:"BasicHeader_main__Vqufr",userBtn:"BasicHeader_userBtn__wlK48",userIcon:"BasicHeader_userIcon__UecGa",userName:"BasicHeader_userName__KiR1h"}},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);